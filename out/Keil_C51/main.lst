C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\out\Keil_C51\main.o
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.exe .\SRC\MAIN.C CODE PRINT(.\out\Keil_C51\main.lst) OMF2 TABS(2) OPTIMIZE(8
                    -,SPEED) SMALL ROM(LARGE) INCDIR(.\dependence;.\src) DEFINE(__UVISION_VERSION) OBJECT(.\out\Keil_C51\main.o)

line level    source

   1          /**
   2           * *********************************************
   3           * 
   4           * 8051 Ultrasonic Distance Measurement System
   5           * 
   6           * Encoding = GBK
   7           * 
   8           * Author:W0n9, SailorYan
   9           * 
  10           * *********************************************
  11          */
  12          
  13          #include "REG52.H"
  14          #include "intrins.h"
  15          // #include "lcd1602.h"
  16          
  17          typedef unsigned char uint8_t;
  18          typedef unsigned int uint16_t;
  19          typedef unsigned long uint32_t;
  20          
  21          typedef signed char int8_t;
  22          typedef signed int int16_t;
  23          typedef signed long int32_t;
  24          
  25          #define XTAL11M
  26          // #define XTAL12M
  27          
  28          #define EXT0_VECTOR 0  /* 0x03 external interrupt 0 */
  29          #define TIM0_VECTOR 1  /* 0x0b timer 0 */
  30          #define EXT1_VECTOR 2  /* 0x13 external interrupt 1 */
  31          #define TIM1_VECTOR 3  /* 0x1b timer 1 */
  32          #define UART0_VECTOR 4 /* 0x23 serial port 0 */
  33          
  34          // sbit RCK_STMM = P2 ^ 7;
  35          // sbit DIO_DS = P2 ^ 6;
  36          // sbit SCK_SHBit = P2 ^ 5;
  37          
  38          sbit Trig_Pin = P2 ^ 1;
  39          sbit Echo_Pin = P2 ^ 0;
  40          sbit Mode_1 = P1 ^ 1;
  41          sbit Mode_2 = P1 ^ 2;
  42          sbit Mode_3 = P1 ^ 3;
  43          
  44          sbit lcden = P3 ^ 4; //使能端:en=1,读取；en=下降沿，执行指令
  45          sbit lcdrs = P3 ^ 5; //数据/指令选择端：rs=1，为数据；rs=0，为指令。
  46          sbit lcdrw = P3 ^ 6; //读写控制端：rw=1,读；rw=0,写
  47          // int W1,W2,W3,W4,W5,W6,W7;
  48          
  49          /***********延时函数******************/
  50          void delayms(uint16_t time)
  51          {
  52   1          uint16_t i;
  53   1          for (; time > 0; time--)
  54   1          {
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 2   

  55   2              for (i = 0; i < 124; i++)
  56   2              {
  57   3                  ;
  58   3              }
  59   2          }
  60   1      }
  61          
  62          /*******************lcd写入指令子函数********************/
  63          void lcd_wcom(uint8_t com)
  64          {
  65   1          lcdrs = 0;  // rs=0,指令
  66   1          lcdrw = 0;  // rw=0,写入
  67   1          P0 = com;   // 把指令送入P0口
  68   1          delayms(5); //延时一小会 ，让1602准备接收数据--------代替忙检测函数
  69   1          lcden = 1;  //使能端 下降沿，把指令送入1602的8为数据口
  70   1          delayms(2);
  71   1          lcden = 0;
  72   1      }
  73          
  74          /************************lcd写入数据函数************************/
  75          void lcd_wdata(uint8_t dat)
  76          {
  77   1          lcdrs = 1;  // RS=1,数据
  78   1          lcdrw = 0;  // rw=0,写入
  79   1          P0 = dat;   // 把要显示的数据送入P0口
  80   1          delayms(5); //延时一小会 ，让1602准备接收数据--------代替忙检测函数
  81   1          lcden = 1;  //使能端 下降沿，把指令送入1602的8为数据口
  82   1          delayms(2);
  83   1          lcden = 0;
  84   1      }
  85          
  86          /******************LCD初始化子函数****************************/
  87          void lcd_init() //初始化，写入指令
  88          {
  89   1          lcdrw = 0; //rw=0,写
  90   1          lcden = 1;
  91   1          lcden = 0;      //下降沿，执行指令
  92   1          lcd_wcom(0x38); //写指令,8位数据，双列
  93   1          lcd_wcom(0x0c); //开启显示屏，关光标，光标不闪烁
  94   1          lcd_wcom(0x06); //显示地址递增，即写一个数据后，显示位置右移一位
  95   1          lcd_wcom(0x01); //清屏
  96   1      }
  97          
  98          /**********************LCD显示子函数****************************/
  99          //i设置字符位置，j是显示的数字
 100          void lcd_display(uint16_t i, uint16_t j)
 101          {
 102   1      
 103   1          lcd_wcom(0x80 + i - 1);
 104   1          switch (j)
 105   1          {
 106   2          case 0:
 107   2              lcd_wdata('0');
 108   2              delayms(2);
 109   2              break;
 110   2          case 1:
 111   2              lcd_wdata('1');
 112   2              delayms(2);
 113   2              break;
 114   2          case 2:
 115   2              lcd_wdata('2');
 116   2              delayms(2);
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 3   

 117   2              break;
 118   2          case 3:
 119   2              lcd_wdata('3');
 120   2              delayms(2);
 121   2              break;
 122   2          case 4:
 123   2              lcd_wdata('4');
 124   2              delayms(2);
 125   2              break;
 126   2          case 5:
 127   2              lcd_wdata('5');
 128   2              delayms(2);
 129   2              break;
 130   2          case 6:
 131   2              lcd_wdata('6');
 132   2              delayms(2);
 133   2              break;
 134   2          case 7:
 135   2              lcd_wdata('7');
 136   2              delayms(2);
 137   2              break;
 138   2          case 8:
 139   2              lcd_wdata('8');
 140   2              delayms(2);
 141   2              break;
 142   2          case 9:
 143   2              lcd_wdata('9');
 144   2              delayms(2);
 145   2              break;
 146   2          default:
 147   2              lcd_wdata('.');
 148   2              delayms(2);
 149   2              break;
 150   2          }
 151   1      }
 152          /*********************最终显示函数*************************************/
 153          //abc分别为百十个位，使用前需lcd_init()初始化
 154          void fin_display(uint16_t a, b, c)
 155          {
 156   1          lcd_wcom(0x80 + 7 - 1);
 157   1          lcd_wdata('M');
 158   1          delayms(2);
 159   1      
 160   1          lcd_wcom(0x80 + 6 - 1);
 161   1          lcd_wdata('C');
 162   1          delayms(2);
 163   1      
 164   1          lcd_display(5, 5);
 165   1          lcd_display(4, '.');
 166   1          lcd_display(3, c);
 167   1          lcd_display(2, b);
 168   1          lcd_display(1, a);
 169   1      }
 170          /**************************主函数*******************************/
 171          // void main()
 172          // {
 173          //  lcd_init();//初始化
 174          //  while(1)
 175          //     {
 176          //  //lcd_display(10,W1);
 177          //  //lcd_display(9,':');
 178          //  // lcd_display(8,1);
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 4   

 179          //  // lcd_display(7,W3);
 180          //    // lcd_display(6,':');
 181          //    // lcd_display(5,W4);
 182          //    // lcd_display(4,W5);
 183          //    lcd_display(10,3);
 184          //  lcd_display(2,2);
 185          //     lcd_display(1,1);
 186          //  }
 187          // }
 188          
 189          void UART_init() //非同步鬏
 190          {
 191   1          SCON = 0x52; //串列控制捍嫫01010010 TI=1 REN=1 01 8位元UART鬏(8-11)
 192   1          TMOD = 0x20; //r的Ｊ捍嫫 00100000    O定定r器1楣ぷ鞣绞2
 193   1          TCON = 0x69; //r悼刂捍嫫 01101001
 194   1          TH1 = 0xFD;  //r捍嫫  <230> U率1200
 195   1          TR1 = 1;     //r悼刂捍嫫餮e面的TR1  //O置波特率 9600bps
 196   1          ES = 1;      //串列中嘀履
 197   1          EA = 1;      //全部中嘣粗履
 198   1      }
 199          
 200          void UARTSnd(uint8_t dat)
 201          {
 202   1      
 203   1          TI = 0;     // clear transmit interrupt flag
 204   1          SBUF = dat; // start sending one byte
 205   1          while (!TI)
 206   1              ; // wait until sent
 207   1      }
 208          
 209          // void Delay10us() //@11.0592MHz
 210          // {
 211          //     uint8_t tempi;
 212          
 213          //     _nop_();
 214          //     tempi = 25;
 215          //     while (--tempi)
 216          //         ;
 217          // }
 218          
 219          // void Timer0Init(void) //10毫秒@11.0592MHz
 220          // {
 221          //     // AUXR &= 0x7F; //定时器时钟12T模式
 222          //     TMOD &= 0xF0; //设置定时器0模式
 223          //     TL0 = 0x00;   //设置定时初值
 224          //     TH0 = 0xDC;   //设置定时初值
 225          //     TF0 = 0;      //清除TF0标志
 226          //     TR0 = 1;      //定时器0开始计时
 227          // }
 228          
 229          #ifdef XTAL11M
 230          uint32_t MeterByTrig()
 231          {
 232   1          // uint8_t tempa;
 233   1          uint8_t tempi;
 234   1          // uint8_t IsOverFlow;
 235   1          uint32_t PresentTime;
 236   1          // IsOverFlow = 0;
 237   1      
 238   1          //Delay1Ms();
 239   1      
 240   1          // P1M1 &= 0X7F;
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 5   

 241   1          // P1M2 &= 0X7F;
 242   1      
 243   1          // P1M1 |= 0X40;
 244   1          // P1M2 &= 0XBF;
 245   1      
 246   1          //Timer Init
 247   1          TMOD &= 0xF1;
 248   1          // TAMOD = 0X00;
 249   1          // TCON = 0X00;
 250   1          TH0 = 0;
 251   1          TL0 = 0;
 252   1      
 253   1          // Module Start
 254   1          Trig_Pin = 0;
 255   1          Trig_Pin = 1;
 256   1          _nop_();
 257   1          tempi = 25;
 258   1          while (--tempi)
 259   1              ;
 260   1          Trig_Pin = 0;
 261   1      
 262   1          // while (1)
 263   1          // {
 264   1          //     if (Echo_Pin == 1)
 265   1          //     {            //Start Timer;
 266   1          //         TR0 = 1; //start timer
 267   1          //         break;
 268   1          //     }
 269   1          //     if (TF0 == 1)
 270   1          //     {
 271   1          //         IsOverFlow = 1;
 272   1          //         break; //overflow;
 273   1          //     }
 274   1          // }
 275   1      
 276   1          // while (1)
 277   1          // {
 278   1          //     if (Echo_Pin == 0)
 279   1          //     { //Stop Timer;
 280   1          //         TR0 = 0;
 281   1          //         break;
 282   1          //     }
 283   1          //     if (TF0 == 1)
 284   1          //     {
 285   1          //         IsOverFlow = 1;
 286   1          //         break; //overflow;
 287   1          //     }
 288   1          // }
 289   1      
 290   1          while (!Echo_Pin)
 291   1              ;
 292   1          TR0 = 1;
 293   1          while (Echo_Pin)
 294   1              ;
 295   1          TR0 = 0;
 296   1      
 297   1          //  uint32_t PresentTime, tempb;
 298   1          PresentTime = TH0;
 299   1          PresentTime <<= 8; // Equal TH0 * 256
 300   1          PresentTime += TL0;
 301   1          //921600 Cycles @11.0592MHz
 302   1          // PresentTime /= 921.6;
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 6   

 303   1          // PresentTime /= 922;
 304   1          // PresentTime *= 17;
 305   1          //  TODO
 306   1          // PresentTime = (uint32_t)(PresentTime * 0.0184);
 307   1          PresentTime = (uint32_t)(PresentTime * 0.0023);
 308   1      
 309   1          // tempb = PresentTime / 137;
 310   1          // PresentTime /= 7; //*3
 311   1      
 312   1          // PresentTime -= tempb; //time, us
 313   1      
 314   1          // tempb = PresentTime / 150;
 315   1          // PresentTime /= 3;
 316   1          // PresentTime += tempb;
 317   1          //Delay1Ms();
 318   1          return PresentTime;
 319   1      }
 320          #endif
 321          
 322          #ifdef XTAL12M
              uint32_t MeterByTrig()
              {
                  uint8_t tempa;
                  uint8_t IsOverFlow;
                  uint32_t PresentTime;
                  IsOverFlow = 0;
              
                  //Delay1Ms();
              
                  // P1M1 &= 0X7F;
                  // P1M2 &= 0X7F;
              
                  // P1M1 |= 0X40;
                  // P1M2 &= 0XBF;
              
                  //Timer Init
                  TMOD &= 0xF5;
                  // TAMOD = 0X00;
                  TCON = 0X00;
                  TH1 = 0;
                  TL1 = 0;
              
                  Trig_Pin = 0;
                  for (tempa = 0; tempa < 10; tempa++) //up for 10us
                  {
                      Trig_Pin = 1;
                  }
                  Trig_Pin = 0;
              
                  while (1)
                  {
                      if (Echo_Pin == 1)
                      {            //Start Timer;
                          TR0 = 1; //start timer
                          break;
                      }
                      if (TF0 == 1)
                      {
                          IsOverFlow = 1;
                          break; //overflow;
                      }
                  }
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 7   

              
                  while (1)
                  {
                      if (Echo_Pin == 0)
                      { //Stop Timer;
                          TR0 = 0;
                          break;
                      }
                      if (TF0 == 1)
                      {
                          IsOverFlow = 1;
                          break; //overflow;
                      }
                  }
              
                  //  uint32_t PresentTime, tempb;
                  PresentTime = TH1;
                  PresentTime <<= 0X08;
                  PresentTime += TL1;
                  //1000000 Cycles @12MHz
                  PresentTime /= 1000;
                  PresentTime *= 17;
              
                  // tempb = PresentTime / 137;
                  // PresentTime /= 7; //*3
              
                  // PresentTime -= tempb; //time, us
              
                  // tempb = PresentTime / 150;
                  // PresentTime /= 3;
                  // PresentTime += tempb;
                  //Delay1Ms();
                  return PresentTime;
              }
              #endif
 400          
 401          void DisplayLength(uint32_t number)
 402          {
 403   1          uint8_t Hundred, Decade, Unit;
 404   1          if (number > 999)
 405   1              number = 0;
 406   1          // Thousand = number / 1000;
 407   1      
 408   1          // number = number % 1000;
 409   1          Hundred = number / 100;
 410   1      
 411   1          number = number % 100;
 412   1          Decade = number / 10;
 413   1      
 414   1          Unit = number % 10;
 415   1      
 416   1          fin_display(Hundred, Decade, Unit);
 417   1          // DisplayLED(1, Thousand, 0);
 418   1          // DisplayLED(2, Hundred, 0);
 419   1          // DisplayLED(3, Decade, 0);
 420   1          // DisplayLED(4, Unit, 0);
 421   1      }
 422          
 423          // void DisplayLED(uint8_t LEDid, uint8_t Value, uint8_t Isdot)
 424          // {
 425          //     uint8_t tempa, tempb;
 426          //     uint8_t tempc, tempd;
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 8   

 427          //     const uint8_t NumValue[11] = {0X40, 0X79, 0X24, 0X30, 0X19, 0X12, 0X02, 0X78, 0X00, 0X10, 0X3F}; //
             -0, 1, 2, 3, 4, 5, 6, 7, 8, 9, -.
 428          
 429          //     tempa = 1;
 430          //     tempa <<= (LEDid - 1);
 431          //     if (Value >= 11) //value should little than 10
 432          //         Value = 0;
 433          //     tempb = NumValue[Value];
 434          //     if (Isdot == 0)
 435          //         tempb += 0X80;
 436          
 437          //     //begin output
 438          //     tempd = 0X80;
 439          //     for (tempc = 0; tempc < 8; tempc++)
 440          //     {
 441          //         SCK_SHBit = 0;
 442          //         SCK_SHBit = 0;
 443          //         DIO_DS = (tempa & tempd);
 444          //         SCK_SHBit = 1;
 445          //         SCK_SHBit = 1;
 446          //         tempd >>= 1;
 447          //     }
 448          
 449          //     tempd = 0X80;
 450          //     for (tempc = 0; tempc < 8; tempc++)
 451          //     {
 452          //         SCK_SHBit = 0;
 453          //         SCK_SHBit = 0;
 454          //         DIO_DS = (tempb & tempd);
 455          //         SCK_SHBit = 1;
 456          //         SCK_SHBit = 1;
 457          //         tempd >>= 1;
 458          //     }
 459          
 460          //     RCK_STMM = 0;
 461          //     RCK_STMM = 0;
 462          //     RCK_STMM = 0;
 463          //     RCK_STMM = 0;
 464          //     RCK_STMM = 1;
 465          //     RCK_STMM = 1;
 466          //     RCK_STMM = 1;
 467          //     RCK_STMM = 1;
 468          //     //Delay1Ms();
 469          // }
 470          
 471          void Delay20ms() //@11.0592MHz
 472          {
 473   1          uint8_t i, j;
 474   1      
 475   1          i = 36;
 476   1          j = 217;
 477   1          do
 478   1          {
 479   2              while (--j)
 480   2                  ;
 481   2          } while (--i);
 482   1      }
 483          
 484          void Delay5s() //@11.0592MHz
 485          {
 486   1          uint8_t i, j, k;
 487   1      
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 9   

 488   1          _nop_();
 489   1          i = 36;
 490   1          j = 5;
 491   1          k = 211;
 492   1          do
 493   1          {
 494   2              do
 495   2              {
 496   3                  while (--k)
 497   3                      ;
 498   3              } while (--j);
 499   2          } while (--i);
 500   1      }
 501          
 502          void Delay1s() //@11.0592MHz
 503          {
 504   1          uint8_t i, j, k;
 505   1      
 506   1          _nop_();
 507   1          i = 11;
 508   1          j = 130;
 509   1          k = 111;
 510   1          do
 511   1          {
 512   2              do
 513   2              {
 514   3                  while (--k)
 515   3                      ;
 516   3              } while (--j);
 517   2          } while (--i);
 518   1      }
 519          
 520          // void greater_than_2m()
 521          // {
 522          //     uint8_t tempj;
 523          //     uint8_t greater_than_2m[] = {0xFD, 0x00, 0x11, 0x01, 0x01, 0x73, 0x6F, 0x75, 0x6E, 0x64, 0x6B, 0xB4
             -, 0xF3, 0xD3, 0xDA, 0xC1, 0xBD, 0xC3, 0xD7, 0xC2};
 524          //     Delay20ms();
 525          //     for (tempj = 0; tempj < 20; tempj++)
 526          //     {
 527          //         UARTSnd(greater_than_2m[tempj]);
 528          //     }
 529          // }
 530          
 531          void greater_than_1m()
 532          {
 533   1          uint8_t tempj;
 534   1          uint8_t greater_than_1m[] = {0xFD, 0x00, 0x11, 0x01, 0x01, 0x73, 0x6F, 0x75, 0x6E, 0x64, 0x6B, 0xB4, 0
             -xF3, 0xD3, 0xDA, 0xD2, 0xBB, 0xC3, 0xD7, 0xD7};
 535   1          Delay20ms();
 536   1          for (tempj = 0; tempj < 20; tempj++)
 537   1          {
 538   2              UARTSnd(greater_than_1m[tempj]);
 539   2          }
 540   1          Delay5s();
 541   1      }
 542          
 543          void less_than_1m()
 544          {
 545   1          uint8_t tempj;
 546   1          uint8_t less_than_1m[] = {0xFD, 0x00, 0x0B, 0x01, 0x01, 0xD0, 0xA1, 0xD3, 0xDA, 0xD2, 0xBB, 0xC3, 0xD7
             -, 0xF3};
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 10  

 547   1          Delay20ms();
 548   1          for (tempj = 0; tempj < 14; tempj++)
 549   1          {
 550   2              UARTSnd(less_than_1m[tempj]);
 551   2          }
 552   1          Delay1s();
 553   1      }
 554          
 555          void main()
 556          {
 557   1          // uint8_t tempa;
 558   1          uint32_t PreLength; //  Unit is cm
 559   1          uint8_t i;
 560   1          uint8_t tempj;
 561   1          uint8_t greater_than_2m[] = {0xFD, 0x00, 0x11, 0x01, 0x01, 0x73, 0x6F, 0x75, 0x6E, 0x64, 0x6B, 0xB4, 0
             -xF3, 0xD3, 0xDA, 0xC1, 0xBD, 0xC3, 0xD7, 0xC2};
 562   1          // uint8_t debug;
 563   1          lcd_init();
 564   1          UART_init();
 565   1      
 566   1          // for (i = 0; i < 1; i++)
 567   1          // { // greater_than_2m();
 568   1      
 569   1          //     Delay20ms();
 570   1          //     for (tempj = 0; tempj < 20; tempj++)
 571   1          //     {
 572   1          //         UARTSnd(greater_than_2m[tempj]);
 573   1          //     }
 574   1          // }
 575   1      
 576   1          // // greater_than_2m();
 577   1          // Delay5s();
 578   1          // for (i = 0; i < 3; i++)
 579   1          // {
 580   1          //     greater_than_1m();
 581   1          // }
 582   1          // // Delay5s();
 583   1          // for (i = 0; i < 3; i++)
 584   1          // {
 585   1          //     less_than_1m();
 586   1          // }
 587   1      
 588   1          while (1)
 589   1          {
 590   2              PreLength = MeterByTrig();
 591   2              DisplayLength(PreLength);
 592   2              // if (PreLength > 200)
 593   2              // {
 594   2              //     for (i = 0; i < 1; i++)
 595   2              //     { // greater_than_2m();
 596   2              //         Delay20ms();
 597   2              //         for (tempj = 0; tempj < 20; tempj++)
 598   2              //         {
 599   2              //             UARTSnd(greater_than_2m[tempj]);
 600   2              //         }
 601   2              //     }
 602   2              // }
 603   2              // else if (PreLength <= 200 && PreLength >= 100)
 604   2              // {
 605   2              //     for (i = 0; i < 3; i++)
 606   2              //     {
 607   2              //         greater_than_1m();
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 11  

 608   2              //     }
 609   2              // }
 610   2              // else if (PreLength <= 100)
 611   2              // {
 612   2              //     for (i = 0; i < 3; i++)
 613   2              //     {
 614   2              //         less_than_1m();
 615   2              //     }
 616   2              // }
 617   2              if (!Mode_1)
 618   2              {
 619   3                  if (PreLength > 200)
 620   3                  {
 621   4                      for (i = 0; i < 1; i++)
 622   4                      { // greater_than_2m();
 623   5                          Delay20ms();
 624   5                          for (tempj = 0; tempj < 20; tempj++)
 625   5                          {
 626   6                              UARTSnd(greater_than_2m[tempj]);
 627   6                          }
 628   5                      }
 629   4                      Delay5s();
 630   4                  }
 631   3              }
 632   2              else if (!Mode_2)
 633   2              {
 634   3                  if (PreLength <= 200 && PreLength >= 100)
 635   3                  {
 636   4                      greater_than_1m();
 637   4                  }
 638   3              }
 639   2              else if (!Mode_3)
 640   2              {
 641   3                  if (PreLength <= 100)
 642   3                  {
 643   4                      less_than_1m();
 644   4                  }
 645   3              }
 646   2      
 647   2              // debug = PreLength / 1000;
 648   2              // UARTSnd(PreLength);
 649   2              // Delay5s();
 650   2      
 651   2              // for (tempa = 0; tempa < 200; tempa++)   //  refresh for 200 cycles
 652   2              // {
 653   2              //     DisplayLength(PreLength);
 654   2              // }
 655   2          }
 656   1      }
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 12  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION L?0101 (BEGIN)
0000 C2B6              CLR     lcdrw
0002 8F80              MOV     P0,R7
0004 7F05              MOV     R7,#05H
0006 7E00              MOV     R6,#00H
0008 120000      R     LCALL   _delayms
000B D2B4              SETB    lcden
000D         L?0102:
000D 7F02              MOV     R7,#02H
000F 7E00              MOV     R6,#00H
             ; FUNCTION _delayms (BEGIN)
                                           ; SOURCE LINE # 50
;---- Variable 'time' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 51
                                           ; SOURCE LINE # 53
0011         ?C0001:
0011 D3                SETB    C
0012 EF                MOV     A,R7
0013 9400              SUBB    A,#00H
0015 EE                MOV     A,R6
0016 9400              SUBB    A,#00H
0018 4015              JC      ?C0007
                                           ; SOURCE LINE # 54
                                           ; SOURCE LINE # 55
;---- Variable 'i' assigned to Register 'R4/R5' ----
001A E4                CLR     A
001B FD                MOV     R5,A
001C FC                MOV     R4,A
001D         ?C0004:
                                           ; SOURCE LINE # 56
                                           ; SOURCE LINE # 58
001D 0D                INC     R5
001E BD0001            CJNE    R5,#00H,?C0087
0021 0C                INC     R4
0022         ?C0087:
0022 ED                MOV     A,R5
0023 647C              XRL     A,#07CH
0025 4C                ORL     A,R4
0026 70F5              JNZ     ?C0004
                                           ; SOURCE LINE # 59
0028         ?C0003:
0028 EF                MOV     A,R7
0029 1F                DEC     R7
002A 70E5              JNZ     ?C0001
002C 1E                DEC     R6
002D         ?C0088:
002D 80E2              SJMP    ?C0001
                                           ; SOURCE LINE # 60
002F         ?C0007:
002F 22                RET     
             ; FUNCTION _delayms (END)

             ; FUNCTION _lcd_wcom (BEGIN)
                                           ; SOURCE LINE # 63
;---- Variable 'com' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 64
                                           ; SOURCE LINE # 65
0000 C2B5              CLR     lcdrs
                                           ; SOURCE LINE # 66
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 13  

                                           ; SOURCE LINE # 67
                                           ; SOURCE LINE # 68
                                           ; SOURCE LINE # 69
                                           ; SOURCE LINE # 70
0002 120000      R     LCALL   L?0101
                                           ; SOURCE LINE # 71
0005 C2B4              CLR     lcden
                                           ; SOURCE LINE # 72
0007 22                RET     
             ; FUNCTION _lcd_wcom (END)

             ; FUNCTION _lcd_wdata (BEGIN)
                                           ; SOURCE LINE # 75
;---- Variable 'dat' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 76
                                           ; SOURCE LINE # 77
0000 D2B5              SETB    lcdrs
                                           ; SOURCE LINE # 78
                                           ; SOURCE LINE # 79
                                           ; SOURCE LINE # 80
                                           ; SOURCE LINE # 81
                                           ; SOURCE LINE # 82
0002 120000      R     LCALL   L?0101
                                           ; SOURCE LINE # 83
0005 C2B4              CLR     lcden
                                           ; SOURCE LINE # 84
0007 22                RET     
             ; FUNCTION _lcd_wdata (END)

             ; FUNCTION lcd_init (BEGIN)
                                           ; SOURCE LINE # 87
                                           ; SOURCE LINE # 88
                                           ; SOURCE LINE # 89
0000 C2B6              CLR     lcdrw
                                           ; SOURCE LINE # 90
0002 D2B4              SETB    lcden
                                           ; SOURCE LINE # 91
0004 C2B4              CLR     lcden
                                           ; SOURCE LINE # 92
0006 7F38              MOV     R7,#038H
0008 120000      R     LCALL   _lcd_wcom
                                           ; SOURCE LINE # 93
000B 7F0C              MOV     R7,#0CH
000D 120000      R     LCALL   _lcd_wcom
                                           ; SOURCE LINE # 94
0010 7F06              MOV     R7,#06H
0012 120000      R     LCALL   _lcd_wcom
                                           ; SOURCE LINE # 95
0015 7F01              MOV     R7,#01H
0017 020000      R     LJMP    _lcd_wcom
             ; FUNCTION lcd_init (END)

             ; FUNCTION _lcd_display (BEGIN)
                                           ; SOURCE LINE # 100
;---- Variable 'j' assigned to Register 'R2/R3' ----
0000 AB05              MOV     R3,AR5
0002 AA04              MOV     R2,AR4
;---- Variable 'i' assigned to Register 'R6/R7' ----
                                           ; SOURCE LINE # 101
                                           ; SOURCE LINE # 103
0004 EF                MOV     A,R7
0005 247F              ADD     A,#07FH
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 14  

0007 FF                MOV     R7,A
0008 120000      R     LCALL   _lcd_wcom
                                           ; SOURCE LINE # 104
000B EA                MOV     A,R2
000C 7053              JNZ     ?C0022
000E EB                MOV     A,R3
000F B40A00            CJNE    A,#0AH,?C0089
0012         ?C0089:
0012 504D              JNC     ?C0022
0014 900000      R     MOV     DPTR,#?C0090
0017 F8                MOV     R0,A
0018 28                ADD     A,R0
0019 28                ADD     A,R0
001A 73                JMP     @A+DPTR
001B         ?C0090:
001B 020000      R     LJMP    ?C0012
001E 020000      R     LJMP    ?C0013
0021 020000      R     LJMP    ?C0014
0024 020000      R     LJMP    ?C0015
0027 020000      R     LJMP    ?C0016
002A 020000      R     LJMP    ?C0017
002D 020000      R     LJMP    ?C0018
0030 020000      R     LJMP    ?C0019
0033 020000      R     LJMP    ?C0020
0036 020000      R     LJMP    ?C0021
                                           ; SOURCE LINE # 105
                                           ; SOURCE LINE # 106
0039         ?C0012:
                                           ; SOURCE LINE # 107
0039 7F30              MOV     R7,#030H
                                           ; SOURCE LINE # 108
                                           ; SOURCE LINE # 109
003B 8026              SJMP    ?C0100
                                           ; SOURCE LINE # 110
003D         ?C0013:
                                           ; SOURCE LINE # 111
003D 7F31              MOV     R7,#031H
003F         ?C0091:
                                           ; SOURCE LINE # 112
                                           ; SOURCE LINE # 113
003F 8022              SJMP    ?C0100
                                           ; SOURCE LINE # 114
0041         ?C0014:
                                           ; SOURCE LINE # 115
0041 7F32              MOV     R7,#032H
0043         ?C0092:
                                           ; SOURCE LINE # 116
                                           ; SOURCE LINE # 117
0043 801E              SJMP    ?C0100
                                           ; SOURCE LINE # 118
0045         ?C0015:
                                           ; SOURCE LINE # 119
0045 7F33              MOV     R7,#033H
0047         ?C0093:
                                           ; SOURCE LINE # 120
                                           ; SOURCE LINE # 121
0047 801A              SJMP    ?C0100
                                           ; SOURCE LINE # 122
0049         ?C0016:
                                           ; SOURCE LINE # 123
0049 7F34              MOV     R7,#034H
004B         ?C0094:
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 15  

                                           ; SOURCE LINE # 124
                                           ; SOURCE LINE # 125
004B 8016              SJMP    ?C0100
                                           ; SOURCE LINE # 126
004D         ?C0017:
                                           ; SOURCE LINE # 127
004D 7F35              MOV     R7,#035H
004F         ?C0095:
                                           ; SOURCE LINE # 128
                                           ; SOURCE LINE # 129
004F 8012              SJMP    ?C0100
                                           ; SOURCE LINE # 130
0051         ?C0018:
                                           ; SOURCE LINE # 131
0051 7F36              MOV     R7,#036H
0053         ?C0096:
                                           ; SOURCE LINE # 132
                                           ; SOURCE LINE # 133
0053 800E              SJMP    ?C0100
                                           ; SOURCE LINE # 134
0055         ?C0019:
                                           ; SOURCE LINE # 135
0055 7F37              MOV     R7,#037H
0057         ?C0097:
                                           ; SOURCE LINE # 136
                                           ; SOURCE LINE # 137
0057 800A              SJMP    ?C0100
                                           ; SOURCE LINE # 138
0059         ?C0020:
                                           ; SOURCE LINE # 139
0059 7F38              MOV     R7,#038H
005B         ?C0098:
                                           ; SOURCE LINE # 140
                                           ; SOURCE LINE # 141
005B 8006              SJMP    ?C0100
                                           ; SOURCE LINE # 142
005D         ?C0021:
                                           ; SOURCE LINE # 143
005D 7F39              MOV     R7,#039H
005F         ?C0099:
                                           ; SOURCE LINE # 144
                                           ; SOURCE LINE # 145
005F 8002              SJMP    ?C0100
                                           ; SOURCE LINE # 146
0061         ?C0022:
                                           ; SOURCE LINE # 147
0061 7F2E              MOV     R7,#02EH
0063         ?C0100:
0063 120000      R     LCALL   _lcd_wdata
                                           ; SOURCE LINE # 148
0066 120000      R     LCALL   L?0102
                                           ; SOURCE LINE # 149
                                           ; SOURCE LINE # 150
                                           ; SOURCE LINE # 151
0069         ?C0023:
0069 22                RET     
             ; FUNCTION _lcd_display (END)

             ; FUNCTION _fin_display (BEGIN)
                                           ; SOURCE LINE # 154
0000 8E00        R     MOV     a,R6
0002 8F00        R     MOV     a+01H,R7
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 16  

0004 8C00        R     MOV     b,R4
0006 8D00        R     MOV     b+01H,R5
0008 8A00        R     MOV     c,R2
000A 8B00        R     MOV     c+01H,R3
                                           ; SOURCE LINE # 155
                                           ; SOURCE LINE # 156
000C 7F86              MOV     R7,#086H
000E 120000      R     LCALL   _lcd_wcom
                                           ; SOURCE LINE # 157
0011 7F4D              MOV     R7,#04DH
0013 120000      R     LCALL   _lcd_wdata
                                           ; SOURCE LINE # 158
0016 120000      R     LCALL   L?0102
                                           ; SOURCE LINE # 160
0019 7F85              MOV     R7,#085H
001B 120000      R     LCALL   _lcd_wcom
                                           ; SOURCE LINE # 161
001E 7F43              MOV     R7,#043H
0020 120000      R     LCALL   _lcd_wdata
                                           ; SOURCE LINE # 162
0023 120000      R     LCALL   L?0102
                                           ; SOURCE LINE # 164
0026 7D05              MOV     R5,#05H
0028 7C00              MOV     R4,#00H
002A 7F05              MOV     R7,#05H
002C 7E00              MOV     R6,#00H
002E 120000      R     LCALL   _lcd_display
                                           ; SOURCE LINE # 165
0031 7D2E              MOV     R5,#02EH
0033 7C00              MOV     R4,#00H
0035 7F04              MOV     R7,#04H
0037 7E00              MOV     R6,#00H
0039 120000      R     LCALL   _lcd_display
                                           ; SOURCE LINE # 166
003C AD00        R     MOV     R5,c+01H
003E AC00        R     MOV     R4,c
0040 7F03              MOV     R7,#03H
0042 7E00              MOV     R6,#00H
0044 120000      R     LCALL   _lcd_display
                                           ; SOURCE LINE # 167
0047 AD00        R     MOV     R5,b+01H
0049 AC00        R     MOV     R4,b
004B 7F02              MOV     R7,#02H
004D 7E00              MOV     R6,#00H
004F 120000      R     LCALL   _lcd_display
                                           ; SOURCE LINE # 168
0052 AD00        R     MOV     R5,a+01H
0054 AC00        R     MOV     R4,a
0056 7F01              MOV     R7,#01H
0058 7E00              MOV     R6,#00H
005A 020000      R     LJMP    _lcd_display
             ; FUNCTION _fin_display (END)

             ; FUNCTION UART_init (BEGIN)
                                           ; SOURCE LINE # 189
                                           ; SOURCE LINE # 190
                                           ; SOURCE LINE # 191
0000 759852            MOV     SCON,#052H
                                           ; SOURCE LINE # 192
0003 758920            MOV     TMOD,#020H
                                           ; SOURCE LINE # 193
0006 758869            MOV     TCON,#069H
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 17  

                                           ; SOURCE LINE # 194
0009 758DFD            MOV     TH1,#0FDH
                                           ; SOURCE LINE # 195
000C D28E              SETB    TR1
                                           ; SOURCE LINE # 196
000E D2AC              SETB    ES
                                           ; SOURCE LINE # 197
0010 D2AF              SETB    EA
                                           ; SOURCE LINE # 198
0012 22                RET     
             ; FUNCTION UART_init (END)

             ; FUNCTION L?0104 (BEGIN)
0000         L?0105:
0000 2E                ADD     A,R6
0001 F8                MOV     R0,A
0002 E6                MOV     A,@R0
0003 FF                MOV     R7,A
             ; FUNCTION _UARTSnd (BEGIN)
                                           ; SOURCE LINE # 200
;---- Variable 'dat' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 201
                                           ; SOURCE LINE # 203
0004 C299              CLR     TI
                                           ; SOURCE LINE # 204
0006 8F99              MOV     SBUF,R7
0008         ?C0026:
                                           ; SOURCE LINE # 205
0008 3099FD            JNB     TI,?C0026
                                           ; SOURCE LINE # 207
000B 22                RET     
             ; FUNCTION _UARTSnd (END)

             ; FUNCTION MeterByTrig (BEGIN)
                                           ; SOURCE LINE # 230
                                           ; SOURCE LINE # 231
                                           ; SOURCE LINE # 247
0000 5389F1            ANL     TMOD,#0F1H
                                           ; SOURCE LINE # 250
0003 E4                CLR     A
0004 F58C              MOV     TH0,A
                                           ; SOURCE LINE # 251
0006 F58A              MOV     TL0,A
                                           ; SOURCE LINE # 254
0008 C2A1              CLR     Trig_Pin
                                           ; SOURCE LINE # 255
000A D2A1              SETB    Trig_Pin
                                           ; SOURCE LINE # 256
000C 00                NOP     
                                           ; SOURCE LINE # 257
;---- Variable 'tempi' assigned to Register 'R7' ----
000D 7F19              MOV     R7,#019H
000F         ?C0029:
                                           ; SOURCE LINE # 258
000F DFFE              DJNZ    R7,?C0029
                                           ; SOURCE LINE # 260
0011 C2A1              CLR     Trig_Pin
0013         ?C0031:
                                           ; SOURCE LINE # 290
0013 30A0FD            JNB     Echo_Pin,?C0031
                                           ; SOURCE LINE # 292
0016 D28C              SETB    TR0
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 18  

0018         ?C0033:
                                           ; SOURCE LINE # 293
0018 20A0FD            JB      Echo_Pin,?C0033
                                           ; SOURCE LINE # 295
001B C28C              CLR     TR0
                                           ; SOURCE LINE # 298
001D AF8C              MOV     R7,TH0
001F E4                CLR     A
0020 8F00        R     MOV     PresentTime+03H,R7
0022 F500        R     MOV     PresentTime+02H,A
0024 F500        R     MOV     PresentTime+01H,A
0026 F500        R     MOV     PresentTime,A
                                           ; SOURCE LINE # 299
0028 AE00        R     MOV     R6,PresentTime+02H
002A AD00        R     MOV     R5,PresentTime+01H
002C AC00        R     MOV     R4,PresentTime
002E 7808              MOV     R0,#08H
0030 120000      E     LCALL   ?C?LSHL
0033 8F00        R     MOV     PresentTime+03H,R7
0035 8E00        R     MOV     PresentTime+02H,R6
0037 8D00        R     MOV     PresentTime+01H,R5
0039 8C00        R     MOV     PresentTime,R4
                                           ; SOURCE LINE # 300
003B AF8A              MOV     R7,TL0
003D E4                CLR     A
003E FC                MOV     R4,A
003F FD                MOV     R5,A
0040 FE                MOV     R6,A
0041 E500        R     MOV     A,PresentTime+03H
0043 2F                ADD     A,R7
0044 F500        R     MOV     PresentTime+03H,A
0046 EE                MOV     A,R6
0047 3500        R     ADDC    A,PresentTime+02H
0049 F500        R     MOV     PresentTime+02H,A
004B ED                MOV     A,R5
004C 3500        R     ADDC    A,PresentTime+01H
004E F500        R     MOV     PresentTime+01H,A
0050 EC                MOV     A,R4
0051 3500        R     ADDC    A,PresentTime
0053 F500        R     MOV     PresentTime,A
                                           ; SOURCE LINE # 307
0055 AF00        R     MOV     R7,PresentTime+03H
0057 AE00        R     MOV     R6,PresentTime+02H
0059 AD00        R     MOV     R5,PresentTime+01H
005B FC                MOV     R4,A
005C E4                CLR     A
005D 120000      E     LCALL   ?C?FCASTL
0060 7B99              MOV     R3,#099H
0062 7ABB              MOV     R2,#0BBH
0064 7916              MOV     R1,#016H
0066 783B              MOV     R0,#03BH
0068 120000      E     LCALL   ?C?FPMUL
006B 120000      E     LCALL   ?C?CASTF
006E 8F00        R     MOV     PresentTime+03H,R7
0070 8E00        R     MOV     PresentTime+02H,R6
0072 8D00        R     MOV     PresentTime+01H,R5
0074 8C00        R     MOV     PresentTime,R4
                                           ; SOURCE LINE # 318
                                           ; SOURCE LINE # 319
0076 22                RET     
             ; FUNCTION MeterByTrig (END)

C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 19  

             ; FUNCTION _DisplayLength (BEGIN)
                                           ; SOURCE LINE # 401
0000 8F00        R     MOV     number+03H,R7
0002 8E00        R     MOV     number+02H,R6
0004 8D00        R     MOV     number+01H,R5
0006 8C00        R     MOV     number,R4
                                           ; SOURCE LINE # 402
                                           ; SOURCE LINE # 404
0008 E4                CLR     A
0009 7FE7              MOV     R7,#0E7H
000B 7E03              MOV     R6,#03H
000D FD                MOV     R5,A
000E FC                MOV     R4,A
000F AB00        R     MOV     R3,number+03H
0011 AA00        R     MOV     R2,number+02H
0013 A900        R     MOV     R1,number+01H
0015 A800        R     MOV     R0,number
0017 D3                SETB    C
0018 120000      E     LCALL   ?C?ULCMP
001B 4009              JC      ?C0036
                                           ; SOURCE LINE # 405
001D E4                CLR     A
001E F500        R     MOV     number+03H,A
0020 F500        R     MOV     number+02H,A
0022 F500        R     MOV     number+01H,A
0024 F500        R     MOV     number,A
0026         ?C0036:
                                           ; SOURCE LINE # 409
0026 E4                CLR     A
0027 7B64              MOV     R3,#064H
0029 FA                MOV     R2,A
002A F9                MOV     R1,A
002B F8                MOV     R0,A
002C AF00        R     MOV     R7,number+03H
002E AE00        R     MOV     R6,number+02H
0030 AD00        R     MOV     R5,number+01H
0032 AC00        R     MOV     R4,number
0034 120000      E     LCALL   ?C?ULDIV
0037 8F00        R     MOV     Hundred,R7
                                           ; SOURCE LINE # 411
0039 AF00        R     MOV     R7,number+03H
003B AE00        R     MOV     R6,number+02H
003D AD00        R     MOV     R5,number+01H
003F AC00        R     MOV     R4,number
0041 E4                CLR     A
0042 7B64              MOV     R3,#064H
0044 FA                MOV     R2,A
0045 F9                MOV     R1,A
0046 F8                MOV     R0,A
0047 120000      E     LCALL   ?C?ULDIV
004A AC00              MOV     R4,AR0
004C AD01              MOV     R5,AR1
004E AE02              MOV     R6,AR2
0050 AF03              MOV     R7,AR3
0052 8F00        R     MOV     number+03H,R7
0054 8E00        R     MOV     number+02H,R6
0056 8D00        R     MOV     number+01H,R5
0058 8C00        R     MOV     number,R4
                                           ; SOURCE LINE # 412
005A E4                CLR     A
005B 7B0A              MOV     R3,#0AH
005D FA                MOV     R2,A
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 20  

005E F9                MOV     R1,A
005F F8                MOV     R0,A
0060 120000      E     LCALL   ?C?ULDIV
0063 8F00        R     MOV     Decade,R7
                                           ; SOURCE LINE # 414
0065 E4                CLR     A
0066 7B0A              MOV     R3,#0AH
0068 FA                MOV     R2,A
0069 F9                MOV     R1,A
006A F8                MOV     R0,A
006B AF00        R     MOV     R7,number+03H
006D AE00        R     MOV     R6,number+02H
006F AD00        R     MOV     R5,number+01H
0071 AC00        R     MOV     R4,number
0073 120000      E     LCALL   ?C?ULDIV
;---- Variable 'Unit' assigned to Register 'R3' ----
                                           ; SOURCE LINE # 416
0076 AF00        R     MOV     R7,Hundred
0078 7E00              MOV     R6,#00H
007A AD00        R     MOV     R5,Decade
007C 7C00              MOV     R4,#00H
007E 7A00              MOV     R2,#00H
0080 020000      R     LJMP    _fin_display
             ; FUNCTION _DisplayLength (END)

             ; FUNCTION L?0103 (BEGIN)
0000 7D00              MOV     R5,#00H
0002 7BFF              MOV     R3,#0FFH
0004 7E00              MOV     R6,#00H
0006 120000      E     LCALL   ?C?COPY
             ; FUNCTION Delay20ms (BEGIN)
                                           ; SOURCE LINE # 471
                                           ; SOURCE LINE # 472
                                           ; SOURCE LINE # 475
;---- Variable 'i' assigned to Register 'R7' ----
0009 7F24              MOV     R7,#024H
                                           ; SOURCE LINE # 476
;---- Variable 'j' assigned to Register 'R6' ----
000B 7ED9              MOV     R6,#0D9H
                                           ; SOURCE LINE # 478
000D         ?C0041:
                                           ; SOURCE LINE # 479
000D DEFE              DJNZ    R6,?C0041
                                           ; SOURCE LINE # 481
000F DFFC              DJNZ    R7,?C0041
                                           ; SOURCE LINE # 482
0011 22                RET     
             ; FUNCTION Delay20ms (END)

             ; FUNCTION Delay5s (BEGIN)
                                           ; SOURCE LINE # 484
                                           ; SOURCE LINE # 485
                                           ; SOURCE LINE # 488
0000 00                NOP     
                                           ; SOURCE LINE # 489
;---- Variable 'i' assigned to Register 'R7' ----
0001 7F24              MOV     R7,#024H
                                           ; SOURCE LINE # 490
;---- Variable 'j' assigned to Register 'R6' ----
0003 7E05              MOV     R6,#05H
                                           ; SOURCE LINE # 491
;---- Variable 'k' assigned to Register 'R5' ----
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 21  

0005 7DD3              MOV     R5,#0D3H
                                           ; SOURCE LINE # 493
                                           ; SOURCE LINE # 495
0007         ?C0050:
                                           ; SOURCE LINE # 496
0007 DDFE              DJNZ    R5,?C0050
                                           ; SOURCE LINE # 498
0009 DEFC              DJNZ    R6,?C0050
                                           ; SOURCE LINE # 499
000B DFFA              DJNZ    R7,?C0050
                                           ; SOURCE LINE # 500
000D 22                RET     
             ; FUNCTION Delay5s (END)

             ; FUNCTION Delay1s (BEGIN)
                                           ; SOURCE LINE # 502
                                           ; SOURCE LINE # 503
                                           ; SOURCE LINE # 506
0000 00                NOP     
                                           ; SOURCE LINE # 507
;---- Variable 'i' assigned to Register 'R7' ----
0001 7F0B              MOV     R7,#0BH
                                           ; SOURCE LINE # 508
;---- Variable 'j' assigned to Register 'R6' ----
0003 7E82              MOV     R6,#082H
                                           ; SOURCE LINE # 509
;---- Variable 'k' assigned to Register 'R5' ----
0005 7D6F              MOV     R5,#06FH
                                           ; SOURCE LINE # 511
                                           ; SOURCE LINE # 513
0007         ?C0059:
                                           ; SOURCE LINE # 514
0007 DDFE              DJNZ    R5,?C0059
                                           ; SOURCE LINE # 516
0009 DEFC              DJNZ    R6,?C0059
                                           ; SOURCE LINE # 517
000B DFFA              DJNZ    R7,?C0059
                                           ; SOURCE LINE # 518
000D 22                RET     
             ; FUNCTION Delay1s (END)

             ; FUNCTION greater_than_1m (BEGIN)
                                           ; SOURCE LINE # 531
                                           ; SOURCE LINE # 532
                                           ; SOURCE LINE # 534
0000 7800        R     MOV     R0,#LOW greater_than_1m
0002 7C00        R     MOV     R4,#HIGH greater_than_1m
0004 7A00        R     MOV     R2,#HIGH _?ix1000
0006 7900        R     MOV     R1,#LOW _?ix1000
0008 7F14              MOV     R7,#014H
                                           ; SOURCE LINE # 535
000A 120000      R     LCALL   L?0103
                                           ; SOURCE LINE # 536
;---- Variable 'tempj' assigned to Register 'R6' ----
000D E4                CLR     A
000E FE                MOV     R6,A
000F         ?C0062:
000F EE                MOV     A,R6
0010 C3                CLR     C
0011 9414              SUBB    A,#014H
0013 7480              MOV     A,#080H
0015 9480              SUBB    A,#080H
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 22  

0017 5008              JNC     ?C0063
                                           ; SOURCE LINE # 537
                                           ; SOURCE LINE # 538
0019 7400        R     MOV     A,#LOW greater_than_1m
001B 120000      R     LCALL   L?0104
                                           ; SOURCE LINE # 539
001E 0E                INC     R6
001F 80EE              SJMP    ?C0062
0021         ?C0063:
                                           ; SOURCE LINE # 540
0021 020000      R     LJMP    Delay5s
             ; FUNCTION greater_than_1m (END)

             ; FUNCTION less_than_1m (BEGIN)
                                           ; SOURCE LINE # 543
                                           ; SOURCE LINE # 544
                                           ; SOURCE LINE # 546
0000 7800        R     MOV     R0,#LOW less_than_1m
0002 7C00        R     MOV     R4,#HIGH less_than_1m
0004 7A00        R     MOV     R2,#HIGH _?ix1001
0006 7900        R     MOV     R1,#LOW _?ix1001
0008 7F0E              MOV     R7,#0EH
                                           ; SOURCE LINE # 547
000A 120000      R     LCALL   L?0103
                                           ; SOURCE LINE # 548
;---- Variable 'tempj' assigned to Register 'R6' ----
000D E4                CLR     A
000E FE                MOV     R6,A
000F         ?C0066:
000F EE                MOV     A,R6
0010 C3                CLR     C
0011 940E              SUBB    A,#0EH
0013 7480              MOV     A,#080H
0015 9480              SUBB    A,#080H
0017 5008              JNC     ?C0067
                                           ; SOURCE LINE # 549
                                           ; SOURCE LINE # 550
0019 7400        R     MOV     A,#LOW less_than_1m
001B 120000      R     LCALL   L?0104
                                           ; SOURCE LINE # 551
001E 0E                INC     R6
001F 80EE              SJMP    ?C0066
0021         ?C0067:
                                           ; SOURCE LINE # 552
0021 020000      R     LJMP    Delay1s
             ; FUNCTION less_than_1m (END)

             ; FUNCTION main (BEGIN)
                                           ; SOURCE LINE # 555
                                           ; SOURCE LINE # 556
                                           ; SOURCE LINE # 561
0000 7800        R     MOV     R0,#LOW greater_than_2m
0002 7C00        R     MOV     R4,#HIGH greater_than_2m
0004 7D00              MOV     R5,#00H
0006 7BFF              MOV     R3,#0FFH
0008 7A00        R     MOV     R2,#HIGH _?ix1002
000A 7900        R     MOV     R1,#LOW _?ix1002
000C 7E00              MOV     R6,#00H
000E 7F14              MOV     R7,#014H
0010 120000      E     LCALL   ?C?COPY
                                           ; SOURCE LINE # 563
0013 120000      R     LCALL   lcd_init
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 23  

                                           ; SOURCE LINE # 564
0016 120000      R     LCALL   UART_init
0019         ?C0070:
                                           ; SOURCE LINE # 588
                                           ; SOURCE LINE # 589
                                           ; SOURCE LINE # 590
0019 120000      R     LCALL   MeterByTrig
001C 8F00        R     MOV     PreLength+03H,R7
001E 8E00        R     MOV     PreLength+02H,R6
0020 8D00        R     MOV     PreLength+01H,R5
0022 8C00        R     MOV     PreLength,R4
                                           ; SOURCE LINE # 591
0024 120000      R     LCALL   _DisplayLength
                                           ; SOURCE LINE # 617
0027 20913F            JB      Mode_1,?C0072
                                           ; SOURCE LINE # 618
                                           ; SOURCE LINE # 619
002A E4                CLR     A
002B 7FC8              MOV     R7,#0C8H
002D FE                MOV     R6,A
002E FD                MOV     R5,A
002F FC                MOV     R4,A
0030 AB00        R     MOV     R3,PreLength+03H
0032 AA00        R     MOV     R2,PreLength+02H
0034 A900        R     MOV     R1,PreLength+01H
0036 A800        R     MOV     R0,PreLength
0038 D3                SETB    C
0039 120000      E     LCALL   ?C?ULCMP
003C 40DB              JC      ?C0070
                                           ; SOURCE LINE # 620
                                           ; SOURCE LINE # 621
;---- Variable 'i' assigned to Register 'R5' ----
003E E4                CLR     A
003F FD                MOV     R5,A
0040         ?C0074:
0040 ED                MOV     A,R5
0041 C3                CLR     C
0042 9401              SUBB    A,#01H
0044 7480              MOV     A,#080H
0046 9480              SUBB    A,#080H
0048 501A              JNC     ?C0075
                                           ; SOURCE LINE # 622
                                           ; SOURCE LINE # 623
004A 120000      R     LCALL   Delay20ms
                                           ; SOURCE LINE # 624
;---- Variable 'tempj' assigned to Register 'R6' ----
004D E4                CLR     A
004E FE                MOV     R6,A
004F         ?C0077:
004F EE                MOV     A,R6
0050 C3                CLR     C
0051 9414              SUBB    A,#014H
0053 7480              MOV     A,#080H
0055 9480              SUBB    A,#080H
0057 5008              JNC     ?C0076
                                           ; SOURCE LINE # 625
                                           ; SOURCE LINE # 626
0059 7400        R     MOV     A,#LOW greater_than_2m
005B 120000      R     LCALL   L?0105
                                           ; SOURCE LINE # 627
005E 0E                INC     R6
005F 80EE              SJMP    ?C0077
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 24  

                                           ; SOURCE LINE # 628
0061         ?C0076:
0061 0D                INC     R5
0062 80DC              SJMP    ?C0074
0064         ?C0075:
                                           ; SOURCE LINE # 629
0064 120000      R     LCALL   Delay5s
                                           ; SOURCE LINE # 630
                                           ; SOURCE LINE # 631
0067 80B0              SJMP    ?C0070
0069         ?C0072:
                                           ; SOURCE LINE # 632
0069 209227            JB      Mode_2,?C0081
                                           ; SOURCE LINE # 633
                                           ; SOURCE LINE # 634
006C E4                CLR     A
006D 7FC8              MOV     R7,#0C8H
006F FE                MOV     R6,A
0070 FD                MOV     R5,A
0071 FC                MOV     R4,A
0072 AB00        R     MOV     R3,PreLength+03H
0074 AA00        R     MOV     R2,PreLength+02H
0076 A900        R     MOV     R1,PreLength+01H
0078 A800        R     MOV     R0,PreLength
007A D3                SETB    C
007B 120000      E     LCALL   ?C?ULCMP
007E 5099              JNC     ?C0070
0080 E4                CLR     A
0081 7F64              MOV     R7,#064H
0083 FE                MOV     R6,A
0084 FD                MOV     R5,A
0085 FC                MOV     R4,A
0086 A800        R     MOV     R0,PreLength
0088 C3                CLR     C
0089 120000      E     LCALL   ?C?ULCMP
008C 408B              JC      ?C0070
                                           ; SOURCE LINE # 635
                                           ; SOURCE LINE # 636
008E 120000      R     LCALL   greater_than_1m
                                           ; SOURCE LINE # 637
                                           ; SOURCE LINE # 638
0091 8086              SJMP    ?C0070
0093         ?C0081:
                                           ; SOURCE LINE # 639
0093 209383            JB      Mode_3,?C0070
                                           ; SOURCE LINE # 640
                                           ; SOURCE LINE # 641
0096 E4                CLR     A
0097 7F64              MOV     R7,#064H
0099 FE                MOV     R6,A
009A FD                MOV     R5,A
009B FC                MOV     R4,A
009C AB00        R     MOV     R3,PreLength+03H
009E AA00        R     MOV     R2,PreLength+02H
00A0 A900        R     MOV     R1,PreLength+01H
00A2 A800        R     MOV     R0,PreLength
00A4 D3                SETB    C
00A5 120000      E     LCALL   ?C?ULCMP
00A8 4003              JC      $ + 5H
00AA 020000      R     LJMP    ?C0070
                                           ; SOURCE LINE # 642
                                           ; SOURCE LINE # 643
C51 COMPILER V9.59.0.0   MAIN                                                              08/24/2020 21:37:11 PAGE 25  

00AD 120000      R     LCALL   less_than_1m
                                           ; SOURCE LINE # 644
                                           ; SOURCE LINE # 645
                                           ; SOURCE LINE # 655
00B0 020000      R     LJMP    ?C0070
             ; FUNCTION main (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    867    ----
   CONSTANT SIZE    =     54    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      74
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
